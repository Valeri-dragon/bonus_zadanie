(()=>{"use strict";const e=e=>fetch(e,{method:"GET"}).then((e=>e.json())).then((e=>e)).catch((e=>console.log("Данные не получены "+e))),t=e=>{const t=document.querySelector("main"),n=document.createElement("div");n.setAttribute("id","heroe-conteiner"),t.innerHTML="",n.innerHTML="",e.forEach((e=>{const a=document.createElement("div"),{name:s,realName:o,species:r,citizenship:l,gender:c,birthDay:i,deathDay:d,status:p,actors:m,photo:u,movies:h}=e;let v=[];h&&h.forEach((e=>{e&&v.push(`<span>${e}</span>`)})),a.classList.add("block-card"),a.innerHTML=`\n      <div class="heroes-card">\n     <div class="row">\n              <img src="db/${u}"  alt="${s}" class="heroe-image"/>\n               <div class="column">\n              <h3>${s}</h3>\n               <p><span class="descrip">real name: </span> ${o||"no data available"}</p>\n               <p><span class="descrip">species: </span> ${r||"no data available"}</p>\n              <p><span class="descrip">citizenship: </span> ${l||"no data available"}</p>\n             <p><span class="descrip">gender: </span> ${c||"no data available"}</p>\n             <p><span class="descrip">birth day: </span> ${i||"no data available"}</p>\n             <p><span class="descrip">deat day: </span> ${d||"no data available"}</p>\n             <p><span class="descrip">status: </span>${p||"no data available"}</p>\n              </div>\n              </div>\n              \n             <p><span class="descrip">actors: </span> ${m||"no data available"}</p>\n           <p class="column"><span class="descrip">movies: </span> ${v.join("")}</p>\n            </div>\n\n      `,n.append(a),t.append(n)}))};e("./dbHeroes.json").then((e=>t(e))),(()=>{const n=document.querySelector(".control-wrapper"),a=document.querySelector(".search-wrapper_input"),s=document.querySelector(".catalog"),o=document.querySelector(".gender"),r=document.createElement("p");let l=!1;const c=()=>{const s=a.value;r.textContent="",e("./dbHeroes.json").then((e=>t(((e,t)=>e.filter((e=>e.name.toLowerCase().includes(t.toLowerCase()))))(e,s)))),r.textContent=`Результат поиска по вашему запросу: ${s}`,n.after(r)},i=((e,t=1e3)=>(...n)=>{n.lastCall=Date.now();let a=n.lastCall;a&&n.lastCall-a<=t&&clearTimeout(n.lastCallTimer),n.lastCallTimer=setTimeout((()=>e(...n)),t)})(c,3e3);a.addEventListener("input",i),a.addEventListener("keydown",(function(e){13===e.keyCode&&c()})),o.addEventListener("change",(a=>{r.textContent="";const s=o.options[o.selectedIndex].textContent;e("./dbHeroes.json").then((e=>t(((e,t)=>e.filter((e=>{if(e.gender.toLowerCase()===t)return e.gender.toLowerCase()===t})))(e,s)))),r.textContent=`Выведены карточки героев пола ${s}`,n.after(r),"Герои по полу"===s&&(e("./dbHeroes.json").then((e=>t(e))),r.textContent="Выведены карточки всех героев")})),n.addEventListener("click",(o=>{o.target.closest(".search-btn")?c():o.target.closest(".catalog-button")&&(l=!l,s.style.display=l?"flex":"",o.target.closest("li")&&(s=>{a.value="";const o=s.textContent;r.textContent="",e("./dbHeroes.json").then((e=>t(((e,t)=>e.filter((e=>{for(let n in e.movies)if(e.movies[n].trim()===t)return e.movies[n].trim()===t})))(e,o)))),r.textContent=`Все герои из фильма ${o}`,n.after(r)})(o.target))}))})()})();